<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.summit.dao.repository.FaceInfoManagerDao">
   <resultMap id="facemanager" type="com.summit.dao.entity.FaceInfo">
       <result column="face_id"  jdbcType="VARCHAR" property="faceid"/>
       <result column="user_name" jdbcType="VARCHAR" property="userName"/>
       <result column="user_id"  jdbcType="VARCHAR" property="userID"/>
       <result column="gender"  jdbcType="INTEGER" property="gender"/>
       <result column="province"  jdbcType="VARCHAR" property="province"/>
       <result column="city"  jdbcType="VARCHAR" property="city"/>
       <result column="card_type" jdbcType="INTEGER"  property="cardType"/>
       <result column="card_id"  jdbcType="VARCHAR" property="cardId"/>
       <result column="birthday" jdbcType="TIMESTAMP" property="birthday" />
       <result column="face_image" jdbcType="VARCHAR" property="faceImage"/>
       <result column="face_type" jdbcType="VARCHAR" property="faceType"/>
       <result column="face_startTime" jdbcType="TIMESTAMP" property="faceStartTime"/>
       <result column="face_endTime" jdbcType="TIMESTAMP" property="faceEndTime"/>
   </resultMap>
    <insert id="insertFaceInfo" parameterType="com.summit.dao.entity.FaceInfo">
        INSERT INTO face_info
        (face_id,face_name,user_name,user_id,gender,birthday,province,city,card_type,
        card_id,face_match_rate,face_lib_name,face_lib_type,device_ip,pic_snapshot_time,face_lib_id,face_image,face_type,face_startTime,face_endTime)
        VALUES (#{faceid},#{faceName},#{userName},#{userID},#{gender},#{birthday},#{province},#{city},#{cardType},
                #{cardId},#{faceMatchrate},#{facelibname},#{facelibtype},
                #{deviceip},#{picsnapshottime},#{facelibid},#{faceImage},#{faceType},#{faceStartTime},#{faceEndTime}
        )
    </insert>
    <sql id="faceInfoCloum">
      face_id,user_name,gender,birthday,province,city,card_type,card_id,face_image,face_type,face_startTime,face_endTime
    </sql>
    <select id="selectFaceInfoByPage" parameterType="com.summit.entity.FaceInfoManagerEntity" resultMap="facemanager">
        SELECT
        <include refid="faceInfoCloum"/>
        FROM  face_info
        <where>
            <if test="faceInfoManagerEntity.userName !=null and faceInfoManagerEntity.userName !=''">
                user_name like concat('%',#{faceInfoManagerEntity.userName}, '%')
            </if>
            <if test="faceInfoManagerEntity.cardId !=null and faceInfoManagerEntity.cardId !=''">
               AND card_id like concat('%',#{faceInfoManagerEntity.cardId}, '%')
            </if>
            <if test="faceInfoManagerEntity.province !=null and faceInfoManagerEntity.province !=''">
                AND province like concat('%',#{faceInfoManagerEntity.province}, '%')
            </if>
            <if test="faceInfoManagerEntity.city !=null and faceInfoManagerEntity.city !=''">
                AND city  like concat('%',#{faceInfoManagerEntity.city}, '%')
            </if>
            <if test="faceInfoManagerEntity.gender !=null">
                AND gender=#{faceInfoManagerEntity.gender}
            </if>
            <if test="faceInfoManagerEntity.cardType !=null">
                AND card_type=#{faceInfoManagerEntity.cardType}
            </if>
            <if test="faceInfoManagerEntity.faceType !=null">
                AND face_type=#{faceInfoManagerEntity.faceType}
            </if>
            <if test="faceInfoManagerEntity.faceEndTime !=null">
                AND face_endTime=#{faceInfoManagerEntity.faceEndTime}
            </if>
        </where>
        ORDER BY
        face_startTime
        DESC
        <if test="page !=null and page.current !=null and page.pageSize !=null">
            limit #{page.current},#{page.pageSize}
        </if>
    </select>
    <select id="selectFaceInfoByID" parameterType="java.lang.String" resultMap="facemanager">
        SELECT
        <include refid="faceInfoCloum"/>
        FROM  face_info
        <where>
          face_id=#{faceid}
        </where>
    </select>
    <select id="selectFaceIdByUserName" resultType="java.lang.String" >
        SELECT
        face_id
        FROM  face_info
        <where>
           user_name=#{userName}
        </where>
    </select>
    <select id="selectAllFaceInfo" resultMap="facemanager" >
        SELECT
        <include refid="faceInfoCloum"/>
        FROM  face_info
    </select>
</mapper>